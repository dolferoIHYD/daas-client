<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">	
		<meta name="viewport" content="width=device-width, initial-scale=1">
	
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
		<!-- Material Design Lite -->
		<script src="https://code.getmdl.io/1.1.3/material.min.js"></script>
		<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
		<!-- Material Design icon font -->
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

		
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script src="http://192.168.1.193:8000/scripts/sockjs-0.3.4.min.js"></script>
		<script src="http://192.168.1.193:8000/scripts/vertxbus.js"></script>

		<title>Courier's list</title>

		
		<script>

   		var eb = new vertx.EventBus("http://52.90.78.153:8080/eventbus");
   		eb.onopen = function () {
       		console.log("opening the socket");
       		eb.registerHandler("order.action", function (msg) {
           		console.log("recieving the message " + msg.status + msg.id);
           		console.log(JSON.stringify(msg));
           		var object = $("<li class='mdl-list__item mdl-list__item--two-line listyl' data-order-id='"+msg.id+"'><span class='mdl-list__item-primary-content'><i class='material-icons' id='icon'>location_on</i><span>"+msg.from+"</span><span class='mdl-list__item-sub-title'>    Статус: "+msg.status+"</span></span></li>");
           		switch(msg.status) {
           			case "pending":
           				object[0].setAttribute("onclick", "location.href='someDeliver.html'");
           				object[0].setAttribute("id", "pending'");
           				$("ul").prepend(object);
           				break;			
						 default:
							object[0].setAttribute("id", "not-pending");
							$(object[0]).removeClass("listyl");
							$("li[data-order-id='"+msg.id+"']").replaceWith(object[0]);

							break;           		
           		}
       		});
   		};
   		
   		eb.onclose = function () {
       	console.log("closing socket");
       	eb = null;
  			};
		</script>		
		
		
		
		<style>
		
			.mdl-list__item-sub-title {
				color: inherit;			
			}
			
			 .listyl .mdl-list__item-sub-title{
					color: black;			 
			 }
			
			.demo-list-two {
  				width: 300px;
			}
			
			a.fill-div {
   			display: block;
    			height: 100%;
    			width: 100%;
    			text-decoration: none;
			}
			
			#not-pending{
				color: grey;			
			}
			
			#pending{
				color: black;			
			}
		</style>
	</head>
	<body>
		<!-- Always shows a header, even in smaller screens. -->
		<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
			<header class="mdl-layout__header">
				<div class="mdl-layout__header-row">
					<!-- Title -->
					<span class="mdl-layout-title" align="center">Заказы</span>
					<!-- Add spacer, to align navigation to the right -->
					<div class="mdl-layout-spacer"></div>
				</div>
			</header>
			
		<ul class="demo-list-two mdl-list">
  		<!--	<li class="mdl-list__item mdl-list__item--two-line">
    			<span class="mdl-list__item-primary-content">
      			<i class="material-icons mdl-list__item-avatar">person</i>
      			<span>
      				<a href="someDeliver.html" class="fill-div">Документы</a>
      			</span>
      			<span class="mdl-list__item-sub-title">Best rated</span>
    			</span>
  			</li>
  			<li class="mdl-list__item mdl-list__item--two-line">
    			<span class="mdl-list__item-primary-content">
      			<i class="material-icons mdl-list__item-avatar">person</i>
      			<span><a href="someDeliver.html" class="fill-div">Кушанья заморские</a></span>
      			<span class="mdl-list__item-sub-title">Excellent rated</span>
    			</span>
  			</li>
  			<li class="mdl-list__item mdl-list__item--two-line">
    			<span class="mdl-list__item-primary-content">
      			<i class="material-icons mdl-list__item-avatar">person</i>
     	 			<span><a href="someDeliver.html" class="fill-div">Препараты</a></span>
      			<span class="mdl-list__item-sub-title">Good rated</span>
    			</span>
  			</li>
-				-->
		</ul>
		
		
	</body>
</html>