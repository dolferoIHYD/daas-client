<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Material Design Lite -->
    <script src="https://code.getmdl.io/1.1.3/material.min.js"></script>
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
    <!-- Material Design icon font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="jquery.min.js"></script>
    <script src="sockjs-0.3.4.min.js"></script>
    <script src="vertxbus.js"></script>
    <script type="text/javascript">
      var eb = new vertx.EventBus("http://52.90.78.153:8080/eventbus");
      eb.onopen = function () {
        console.log("opening the socket");
      };
   
      eb.onclose = function () {
        console.log("closing socket");
        eb = null;
      };

      function getFieldValue(field) {
        var element = document.getElementById(field); 
        return element ? element.value : "";
      }

      function submitNewOrder() {
        var fromValue = getFieldValue("fromField");
        var toValue = getFieldValue("toField");
        var commentValue = getFieldValue("commentField");

        var order = {from: fromValue, to: toValue, comment: commentValue};

        console.log("Submitting order", order);
        eb.send("order.create", order, function (msg) {
          console.log("cool " + msg);
        }, function (msg) {
          console.log("not cool " + msg);
        });
      }
    </script>
  </head>
  <body>
    <!-- Always shows a header, even in smaller screens. -->
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <span class="mdl-layout-title">Оформить заказ</span>
        </div>
      </header>
      <main class="mdl-layout__content" style="text-align: center">
        <div class="mdl-textfield mdl-js-textfield">
          <input class="mdl-textfield__input" type="text" id="fromField">
          <label class="mdl-textfield__label" for="sample1">Откуда...</label>
        </div>
        <div class="mdl-textfield mdl-js-textfield">
          <input class="mdl-textfield__input" type="text" id="toField">
          <label class="mdl-textfield__label" for="sample1">Куда...</label>
        </div>
        <div class="mdl-textfield mdl-js-textfield">
          <textarea class="mdl-textfield__input" type="text" rows= "5" id="commentField" ></textarea>
          <label class="mdl-textfield__label" for="sample5">Комментарий...</label>
        </div>
        <!-- Colored raised button -->
        <div style="padding: 10px">
          <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" style="height: 48px; width: 100%;" onclick="location.href='third.html'; submitNewOrder();">
            Сделать заказ
          </button>
        </div>
      </main>
    </div>
  </body>
</html>
